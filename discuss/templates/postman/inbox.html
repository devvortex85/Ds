{% extends "postman/base.html" %}
{% load i18n %}
{% load core_tags %}
{% load custom_postman_tags %}

{% block pm_headerblock %}{% trans "Inbox" %}{% endblock %}

{% block pm_body %}
<div class="mb-3">
    <form action="{% url 'postman:inbox' %}" method="get">
        <div class="input-group">
            <input type="text" name="q" class="form-control" placeholder="{% trans 'Search' %}" value="{{ request.GET.q }}">
            <button type="submit" class="btn btn-outline-secondary">{% trans "Go" %}</button>
        </div>
    </form>
</div>

{% if pm_messages %}
<div class="table-responsive">
    <table class="table table-hover">
        <thead>
            <tr>
                <th>{% trans "Sender" %}</th>
                <th>{% trans "Subject" %}</th>
                <th>{% trans "Date" %}</th>
                <th>{% trans "Action" %}</th>
            </tr>
        </thead>
        <tbody>
            {% for message in pm_messages %}
            <tr{% if message.is_new %} class="table-primary"{% endif %}>
                <td>{{ message.sender|or_me:user }}</td>
                <td>
                    {% if message.is_new %}<span class="badge bg-success">{% trans "New" %}</span>{% endif %}
                    <a href="{% url 'postman:view' message.pk %}{% if request.GET.q %}?q={{ request.GET.q }}{% endif %}">{{ message.subject }}</a>
                </td>
                <td>{{ message.sent_at|date:"SHORT_DATETIME_FORMAT" }}</td>
                <td>
                    <div class="btn-group btn-group-sm" role="group">
                        <a href="{% url 'postman:archive' message.pk %}?next={{ request.path }}" class="btn btn-outline-secondary" title="{% trans 'Archive' %}">
                            <i class="bi bi-archive"></i>
                        </a>
                        <a href="{% url 'postman:delete' message.pk %}?next={{ request.path }}" class="btn btn-outline-danger" title="{% trans 'Delete' %}">
                            <i class="bi bi-trash"></i>
                        </a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% else %}
<p>{% trans "No messages." %}</p>
{% endif %}
{% endblock %}
