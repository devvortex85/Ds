{% comment %}
  Template for displaying the comment reply form inline
  
  Parameters:
  - comment: The comment to reply to (required)
  - post: The post the comment belongs to (required if no comment provided)
  
  Usage:
  {% include 'core/includes/comment_reply_form.html' with comment=comment %}
  or
  {% include 'core/includes/comment_reply_form.html' with post=post %}
{% endcomment %}

<div class="comment-actions">
    <button class="comment-reply-toggle btn btn-sm btn-outline-secondary" 
            data-comment-id="{% if comment %}{{ comment.id }}{% endif %}"
            aria-expanded="false"
            aria-controls="reply-form-{% if comment %}{{ comment.id }}{% else %}new{% endif %}">
        <i class="bi bi-reply-fill me-1" aria-hidden="true"></i> Reply
    </button>

    <div class="comment-reply-form collapse" id="reply-form-{% if comment %}{{ comment.id }}{% else %}new{% endif %}">
        {% if user.is_authenticated %}
            <form method="post" action="{% if comment %}{% url 'comment_reply' comment.id %}{% else %}{% url 'comment_create' post.id %}{% endif %}" class="mt-2">
                {% csrf_token %}
                <div class="mb-3">
                    <textarea name="content" rows="3" class="form-control" placeholder="Write your reply..." required aria-label="Your reply"></textarea>
                </div>
                <div class="text-end">
                    <button type="button" class="btn btn-sm btn-outline-secondary me-2 reply-cancel">Cancel</button>
                    <button type="submit" class="btn btn-sm btn-primary">
                        Submit
                    </button>
                </div>
            </form>
        {% else %}
            <div class="alert alert-secondary mt-2" role="alert">
                <a href="{% url 'login' %}?next={{ request.path }}" class="alert-link">Log in</a> to reply to this comment.
            </div>
        {% endif %}
    </div>
</div>