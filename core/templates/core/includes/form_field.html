{% comment %}
Consolidated form field template
Parameters:
- field: The form field to render
- show_label: Boolean to display the label (default: True)
- custom_label: Custom label text (optional)
- placeholder: Custom placeholder text (optional)
- help_text: Custom help text (optional)
- input_class: Additional CSS classes for the input (optional)
- input_attrs: Additional HTML attributes for the input (optional)
{% endcomment %}

<div class="mb-3 {% if field.errors %}has-error{% endif %}">
    {% if show_label|default:True %}
    <label for="{{ field.id_for_label }}" class="form-label">
        {{ custom_label|default:field.label }}
        {% if field.field.required %}<span class="text-danger">*</span>{% endif %}
    </label>
    {% endif %}
    
    {% if field|fieldtype == 'CheckboxInput' %}
        <div class="form-check">
            {{ field }}
            <label class="form-check-label" for="{{ field.id_for_label }}">
                {{ custom_label|default:field.label }}
            </label>
        </div>
    {% elif field|fieldtype == 'RadioSelect' %}
        {{ field }}
    {% elif field|fieldtype == 'CheckboxSelectMultiple' %}
        {{ field }}
    {% elif field|fieldtype == 'Select' or field|fieldtype == 'SelectMultiple' %}
        {{ field }}
    {% elif field|fieldtype == 'Textarea' %}
        <textarea name="{{ field.name }}"
                  id="{{ field.id_for_label }}"
                  class="form-control {{ input_class|default:'' }}"
                  placeholder="{{ placeholder|default:field.field.widget.attrs.placeholder|default:'' }}"
                  {% if field.field.required %}required{% endif %}
                  {{ input_attrs|default:'' }}
                  rows="{{ field.field.widget.attrs.rows|default:'3' }}">{{ field.value|default:'' }}</textarea>
    {% elif field|fieldtype == 'FileInput' %}
        {% if field.value %}
        <div class="mb-2">
            <p class="form-text">Current: {{ field.value }}</p>
            {% if field.value|is_image %}
            <img src="{{ field.value.url }}" alt="Current image" class="img-thumbnail mb-2" style="max-width: 200px;">
            {% endif %}
        </div>
        {% endif %}
        {{ field }}
    {% else %}
        <input type="{{ field.field.widget.input_type|default:'text' }}"
               name="{{ field.name }}"
               id="{{ field.id_for_label }}"
               class="form-control {{ input_class|default:'' }}"
               placeholder="{{ placeholder|default:field.field.widget.attrs.placeholder|default:'' }}"
               value="{{ field.value|default:'' }}"
               {% if field.field.required %}required{% endif %}
               {{ input_attrs|default:'' }}>
    {% endif %}
    
    {% if field.errors %}
    <div class="text-danger">
        {% for error in field.errors %}
        <small>{{ error }}</small>
        {% endfor %}
    </div>
    {% endif %}
    
    {% if help_text or field.help_text %}
    <div class="form-text">{{ help_text|default:field.help_text }}</div>
    {% endif %}
</div>